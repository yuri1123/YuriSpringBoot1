<!doctype html>
<html lang="ko">
<html xmlns:th="http://www.thymleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"></html>
<head>

    <style>
        .new_input {
            width: 80%;
            border: 1px solid #bbb;
            border-radius: 8px;
            padding: 10px 15px 12px 15px;
            font-size: 14px;
        }

        .new_button {
            border: 1px solid #bbb;
            border-radius: 8px;
            padding: 8px 15px 8px 15px;
            font-size: 14px;
        }
    </style>

</head>
<body>

<th:block th:include="@{/header.html}"></th:block>
<div class="container">
    <div class="row">
        <div class="col-sm-1"></div>
        <div class="col-sm-10">
            <h1>[[${board.subject}]]<span style="font-size:14px;"> ğŸ‘ï¸ ì¡°íšŒìˆ˜ : [[${board.viewcount}]]</span></h1>

            <table class="table text-center table-bordered border-primary">
                <colgroup>
                    <col style="width: 30%;">
                    <col style="width: 70%; ">
                </colgroup>
                <tr>
                    <th class="text-right">ê¸€ë²ˆí˜¸</th>
                    <td class="text-left" style="padding-left:10px;">[[${board.id}]]</td>
                </tr>

                <tr>
                    <th class="text-right">ê¸€ì œëª©</th>
                    <td class="text-left" style="padding-left:10px;">[[${board.subject}]]</td>
                </tr>
                <tr>
                    <th class="text-right">ê¸€ë‚´ìš©</th>
                    <td class="text-left" style="height: 300px; padding-left:10px">[[${board.content}]]</td>
                </tr>
                <tr>
                    <th class="text-right">ì‘ì„±ì</th>
                    <td class="text-left" style="padding-left:10px;">[[${board.createdby}]]</td>
                </tr>
                <tr>
                    <th class="text-right">ì‘ì„±ì¼ì</th>
                    <td class="text-left" style="padding-left:10px;">[[${board.regdate}]]</td>
                </tr>
            </table>
            <p class="btn_set text-center">
                <button type="button" onclick="goWritePage();" class="btns btn_bdr3 btn_mid new_button">ìˆ˜ì •</button>
                <button type="button" onclick="deletePost();" class="btns btn_bdr3 btn_mid new_button">ì‚­ì œ</button>
                <button type="button" onclick="goListPage();" class="btns btn_bdr3 btn_mid new_button">ë’¤ë¡œ</button>
            </p>
        </div>
        <div class="col-sm-1"></div>
    </div>
    <div class="row">
        <div class="col-sm-1"></div>
        <div class="col-sm-10">
            <h4>ëŒ“ê¸€ë³´ê¸°</h4>
            <hr>
            <!--ë°˜ë³µêµ¬ê°„-->
            <th:block th:each="list : ${replyList}" >
            <p class="text-left" style="padding-left:10px;color: rgba(77,211,168,0.85)">[[${list.createdby}]]
                <span style="font-size: 12px;color: #cccccc">  [[${list.regdate}]]</span></p>
            <p class="text-left" style="height: 30px; padding-left:10px">[[${list.replycontent}]]
                <span style="font-size: 12px;color: #cccccc" class="text-right"> ì‚­ì œ , ìˆ˜ì •</span></p>
            <hr>
            </th:block>
            <!--ë°˜ë³µêµ¬ê°„ end-->
            <!--ëŒ“ê¸€ì“°ê¸° -->
            <form style="text-align: right;" role="form" th:action="@{/createreply}" method="post">
                <input class="text-left new_input" style="height: 100px; width: 100%; padding-left:10px"
                       value="ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”." name="replycontent">
                <input type="hidden" name="boardid" th:value="${board.id}">
                <input type="hidden" name="createdby" th:value="${session.user.userid}">
                <input type="hidden" name="modifiedby" th:value="${session.user.userid}">
                <input class="new_button" style="margin-top:3px;" type="submit" value="ëŒ“ê¸€ë“±ë¡">
            </form>
        </div>
        <div class="col-sm-1"></div>
    </div>
</div>

<script>
    // ê²Œì‹œê¸€ ìˆ˜ì • í˜ì´ì§€ë¡œ ì´ë™
    function goWritePage() {
        location.href = '/updateboard/' + location.search;
    }

    // ê²Œì‹œê¸€ ì‚­ì œ
    function deletePost() {

        const id = [[ ${board.id}]];

        if (!confirm(id + 'ë²ˆ ê²Œì‹œê¸€ì„ ì‚­ì œí• ê¹Œìš”?')) {
            return false;
        }

        let inputHtml = '';

        new URLSearchParams(location.search).forEach((value, key) => {
            inputHtml += `<input type="hidden" name="${key}" value="${value}" />`;
        })

        const formHtml = `
            <form id="deleteForm" action="/deleteboard/" method="post">
                ${inputHtml}
            </form>
        `;

        const doc = new DOMParser().parseFromString(formHtml, 'text/html');
        const form = doc.body.firstChild;
        document.body.append(form);
        document.getElementById('deleteForm').submit();
    }

    // ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ë¡œ ì´ë™
    function goListPage() {
        const queryString = new URLSearchParams(location.search);
        queryString.delete('id');
        location.href = '/board + ' ? ' + queryString.toString();
    }
</script>

<hr>
<th:block th:include="@{/footer.html}"></th:block>

</body>
</html>